<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>F1 - Race Results</title>
        <link
            rel="stylesheet"
            href="{{ url_for('static',filename='styles/style.css') }}"
        />
    </head>
    <body>
        <div class="topnav">
            <a href="/">Home</a>
            <a href="/races">Races</a>
            <a href="/who_won">Who Won?</a>
            <a href="/drivers">Drivers</a>
            <a href="/driver_stats">Driver Stats</a>
            <a href="/results">Results</a>
            <a href="/pit_stops">Pit Stops</a>
            <a href="/driver_standings">Driver Standings</a>
            <a href="/sprint_results">Sprint Results</a>
            <a href="/circuits">Circuits</a>
            <a href="/qualifying">Qualifying</a>
        </div>

        <h1>F1 - Race Results</h1>

        <button onclick="openAddModal()">Add New Result</button>

        <!-- Add a hidden form for adding a new result -->
        <div id="addModal" class="modal">
            <div class="modal-content">
                <form class="modal-form">
                    <label for="race_id">Race ID:</label>
                    <input
                        type="text"
                        name="race_id"
                        placeholder="Enter Race ID"
                        required
                    />

                    <label for="driver_id">Driver ID:</label>
                    <input
                        type="text"
                        name="driver_id"
                        placeholder="Enter Driver ID"
                        required
                    />

                    <label for="constructor_id">Constructor ID:</label>
                    <input
                        type="text"
                        name="constructor_id"
                        placeholder="Enter Constructor ID"
                        required
                    />

                    <label for="number">Number:</label>
                    <input
                        type="text"
                        name="number"
                        placeholder="Enter Number"
                        required
                    />

                    <label for="grid">Grid:</label>
                    <input
                        type="text"
                        name="grid"
                        placeholder="Enter Grid"
                        required
                    />

                    <label for="position">Position:</label>
                    <input
                        type="text"
                        name="position"
                        placeholder="Enter Position"
                        required
                    />

                    <label for="position_text">Position Text:</label>
                    <input
                        type="text"
                        name="position_text"
                        placeholder="Enter Position Text"
                        required
                    />

                    <label for="position_order">Position Order:</label>
                    <input
                        type="text"
                        name="position_order"
                        placeholder="Enter Position Order"
                        required
                    />

                    <label for="points">Points:</label>
                    <input
                        type="text"
                        name="points"
                        placeholder="Enter Points"
                        required
                    />

                    <label for="laps">Laps:</label>
                    <input
                        type="text"
                        name="laps"
                        placeholder="Enter Laps"
                        required
                    />

                    <label for="time">Time:</label>
                    <input
                        type="text"
                        name="time"
                        placeholder="Enter Time"
                        required
                    />

                    <label for="milliseconds">Milliseconds:</label>
                    <input
                        type="text"
                        name="milliseconds"
                        placeholder="Enter Milliseconds"
                        required
                    />

                    <label for="fastest_lap">Fastest Lap:</label>
                    <input
                        type="text"
                        name="fastest_lap"
                        placeholder="Enter Fastest Lap"
                        required
                    />

                    <label for="rank">Rank:</label>
                    <input
                        type="text"
                        name="rank"
                        placeholder="Enter Rank"
                        required
                    />

                    <label for="fastest_lap_time">Fastest Lap Time:</label>
                    <input
                        type="text"
                        name="fastest_lap_time"
                        placeholder="Enter Fastest Lap Time"
                        required
                    />

                    <label for="fastest_lap_speed">Fastest Lap Speed:</label>
                    <input
                        type="text"
                        name="fastest_lap_speed"
                        placeholder="Enter Fastest Lap Speed"
                        required
                    />

                    <label for="status_id">Status ID:</label>
                    <input
                        type="text"
                        name="status_id"
                        placeholder="Enter Status ID"
                        required
                    />

                    <button type="submit">Add Result</button>
                    <button type="button" onclick="closeAddModal()">
                        Cancel
                    </button>
                </form>
            </div>
        </div>

        <table>
            <tr>
                <th>ID</th>
                <th>Race ID</th>
                <th>Driver ID</th>
                <th>Constructor ID</th>
                <th>Number</th>
                <th>Grid</th>
                <th>Position</th>
                <th>Position Text</th>
                <th>Position Order</th>
                <th>Points</th>
                <th>Laps</th>
                <th>Time</th>
                <th>Milliseconds</th>
                <th>Fastest Lap</th>
                <th>Rank</th>
                <th>Fastest Lap Time</th>
                <th>Fastest Lap Speed</th>
                <th>Status ID</th>
                <th>Edit</th>
                <th>Delete</th>
            </tr>
            {% for result in results %}
            <tr>
                <td>{{ result[0] }}</td>
                <td>{{ result[1] }}</td>
                <td>{{ result[2] }}</td>
                <td>{{ result[3] }}</td>
                <td>{{ result[4] }}</td>
                <td>{{ result[5] }}</td>
                <td>{{ result[6] }}</td>
                <td>{{ result[7] }}</td>
                <td>{{ result[8] }}</td>
                <td>{{ result[9] }}</td>
                <td>{{ result[10] }}</td>
                <td>{{ result[11] }}</td>
                <td>{{ result[12] }}</td>
                <td>{{ result[13] }}</td>
                <td>{{ result[14] }}</td>
                <td>{{ result[15] }}</td>
                <td>{{ result[16] }}</td>
                <td>{{ result[17] }}</td>
                <td>
                    <a
                        href="javascript:void(0);"
                        onclick="openEditModal(${result.id})"
                        >Edit</a
                    >
                </td>
                <td>
                    <a
                        onclick="return confirm('Are you sure you want to delete this result?')"
                        >Delete</a
                    >
                </td>
            </tr>
            {% endfor %}
        </table>

        <!-- ... (JavaScript code for modals) -->

        <script>
            function openAddModal() {
                document.getElementById("addModal").style.display = "block";
            }

            function closeAddModal() {
                document.getElementById("addModal").style.display = "none";
            }
            // function openEditModal(id) {
            //     // Populate the edit form with data from the selected row
            //     // (you need to write this function based on your requirements)
            //     populateEditForm(id);
            //     document.getElementById("editForm").style.display = "block";
            // }

            function deleteResult() {
                // Make an asynchronous request to delete the result
                fetch("/delete_result/" + window.resultIdToDelete, {
                    method: "DELETE",
                }).then((response) => {
                    if (response.ok) {
                        // Reload the page or update the table after deletion
                        window.location.reload();
                    } else {
                        console.error("Error deleting result");
                    }
                });
            }

            // function populateEditForm(id) {
            //     // Fetch the data for the selected ID
            //     fetch(`/get_result_data/${id}`) // Bu endpoint'i, verileri getirecek bir endpoint ile değiştirmeniz gerekebilir
            //         .then((response) => response.json())
            //         .then((data) => {
            //             // Set values for the form fields based on the retrieved data
            //             document.getElementById("editId").value = data.id;
            //             document.getElementById("editRaceId").value =
            //                 data.raceId;
            //             document.getElementById("editDriverId").value =
            //                 data.driverId;
            //             document.getElementById("editConstructorId").value =
            //                 data.constructorId;
            //             document.getElementById("editNumber").value =
            //                 data.number;
            //             document.getElementById("editGrid").value = data.grid;
            //             document.getElementById("editPosition").value =
            //                 data.position;
            //             document.getElementById("editPositionText").value =
            //                 data.positionText;
            //             document.getElementById("editPositionOrder").value =
            //                 data.positionOrder;
            //             document.getElementById("editPoints").value =
            //                 data.points;
            //             document.getElementById("editLaps").value = data.laps;
            //             document.getElementById("editTime").value = data.time;
            //             document.getElementById("editMilliseconds").value =
            //                 data.milliseconds;
            //             document.getElementById("editFastestLap").value =
            //                 data.fastestLap;
            //             document.getElementById("editRank").value = data.rank;
            //             document.getElementById("editFastestLapTime").value =
            //                 data.fastestLapTime;
            //             document.getElementById("editFastestLapSpeed").value =
            //                 data.fastestLapSpeed;
            //             document.getElementById("editStatusId").value =
            //                 data.statusId;
            //         })
            //         .catch((error) =>
            //             console.error("Error fetching result data:", error)
            //         );
            // }
        </script>
    </body>
</html>
